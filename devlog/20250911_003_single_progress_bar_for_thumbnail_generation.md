### 제목: 썸네일 생성 시 단일 프로그레스 바 표시 기능 구현 계획 (단일 스레드)

-   **날짜:** 2025-09-11
-   **작성자:** Gemini

### 1. 배경

-   현재 `CTHarvester`는 디렉토리를 열 때 각 LoD(Level of Detail) 레벨별로 별도의 프로그레스 바를 표시함.
-   이로 인해 전체 진행 상황을 직관적으로 파악하기 어려움.
-   사용자 경험을 개선하기 위해, 전체 썸네일 생성 과정을 0~100%로 표현하는 단일 프로그레스 바로 통합하고자 함.
-   이번 계획은 우선 단일 스레드 환경에서의 구현을 목표로 함.

### 2. 구현 목표

-   썸네일 생성 및 확인에 필요한 전체 작업량을 미리 계산.
-   계산된 총 작업량을 기반으로 하는 단일 프로그레스 바를 구현.
-   작업 진행에 따라 프로그레스 바의 상태를 업데이트하고, 현재 처리 중인 파일 정보를 텍스트로 표시.

### 3. 세부 실행 계획

#### 1단계: 핵심 로직 위치 파악
-   `CTHarvester.py` 파일에서 디렉토리를 여는 기능(`open_dir` 또는 유사한 이름의 메서드)과 썸네일 생성/처리 로직이 포함된 부분을 찾습니다.

#### 2단계: 전체 작업량 산정 기능 추가
-   본격적인 파일 처리 루프에 진입하기 전에, 앞으로 수행할 모든 작업의 총량을 계산하는 코드를 추가합니다.
-   **산정 방식:**
    -   `총 작업량 = (각 LoD 레벨별로 읽고 쓸 파일 수의 총합) + (기존 썸네일 확인에 필요한 파일 수)`
    -   이 계산을 통해 프로그레스 바의 `maximum` 값을 설정합니다.

#### 3단계: 프로그레스 바 로직 수정
-   기존의 여러 프로그레스 바를 생성하던 코드를 제거합니다.
-   파일 처리 루프 시작 전에 단일 `QProgressDialog`를 생성하고, 최댓값을 2단계에서 구한 '총 작업량'으로 설정합니다.
-   파일을 하나씩 처리할 때마다 카운터를 증가시키고, 이 카운터 값을 프로그레스 바의 `value`로 설정합니다 (`progress.setValue(current_step)`).
-   프로그레스 바의 레이블 텍스트를 `f"Processing Level 1/4: {i+1}/{num_images}"`와 같이 현재 상태를 나타내도록 업데이트합니다.

#### 4단계: UI 응답성 유지
-   단일 스레드에서 무거운 작업을 실행하면 GUI가 멈출 수 있습니다.
-   이를 방지하기 위해, 파일 처리 루프 내에서 주기적으로 `QApplication.processEvents()`를 호출하여 UI가 이벤트를 처리하고 프로그레스 바를 새로 그릴 수 있도록 합니다.

### 4. 추후 개선 사항

-   현재 계획은 단일 스레드 구현에 초점을 맞추고 있으나, 장기적으로는 UI 멈춤 현상을 근본적으로 해결하기 위해 썸네일 생성 로직 전체를 별도의 워커 스레드(`QThread`)로 분리하는 것이 바람직합니다.
