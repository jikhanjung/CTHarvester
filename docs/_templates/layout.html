{% extends "!layout.html" %}

{% block extrahead %}
{{ super() }}
<style>
  .language-switcher {
    position: fixed;
    top: 10px;
    right: 10px;
    z-index: 1000;
    background: #2c3e50;
    border: 1px solid #34495e;
    border-radius: 4px;
    padding: 8px 15px;
    font-size: 13px;
    box-shadow: 0 2px 4px rgba(0,0,0,0.2);
  }
  .language-switcher a {
    margin: 0 5px;
    text-decoration: none;
    color: #3498db;
    font-weight: 500;
    transition: color 0.2s;
    cursor: pointer;
  }
  .language-switcher a:hover {
    color: #5dade2;
    text-decoration: underline;
  }
  .language-switcher .current {
    color: #ecf0f1;
    font-weight: 600;
    cursor: default;
    margin: 0 5px;
  }
  .language-switcher .separator {
    color: #7f8c8d;
    margin: 0 3px;
  }
  .language-switcher .icon {
    margin-right: 5px;
  }
</style>
<script>
  // Language switcher: preserve current page path when switching languages
  function switchLanguage(targetLang) {
    var currentPath = window.location.pathname;
    var newPath;

    // Get the page name (e.g., 'index.html', 'user_guide.html')
    var pageName = currentPath.split('/').pop() || 'index.html';

    // Build new path based on build structure
    if (currentPath.includes('/_build/html/')) {
      // Local build: /_build/html/en/ or /_build/html/ko/
      var basePath = currentPath.substring(0, currentPath.indexOf('/_build/html/') + 13);
      newPath = basePath + '/' + targetLang + '/' + pageName;
    } else if (currentPath.includes('/en/') || currentPath.includes('/ko/')) {
      // Already has language code
      newPath = currentPath.replace(/\/(en|ko)\//, '/' + targetLang + '/');
    } else {
      // Default: try to insert language before page name
      var pathParts = currentPath.split('/');
      pathParts.splice(-1, 0, targetLang);
      newPath = pathParts.join('/');
    }

    window.location.href = newPath;
  }
</script>
{% endblock %}

{% block document %}
<div class="language-switcher">
  <span class="icon">üåê</span>
  {% if language == 'ko' %}
    <a onclick="switchLanguage('en')">English</a><span class="separator">|</span><span class="current">ÌïúÍµ≠Ïñ¥</span>
  {% else %}
    <span class="current">English</span><span class="separator">|</span><a onclick="switchLanguage('ko')">ÌïúÍµ≠Ïñ¥</a>
  {% endif %}
</div>
{{ super() }}
{% endblock %}
